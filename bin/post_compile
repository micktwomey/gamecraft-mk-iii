#!/usr/bin/env bash
set -veo pipefail

# From https://github.com/jiaaro/heroku-buildpack-django

# The post_compile hook is run by heroku-buildpack-python

echo "-----> Running post-compile hook"

if [ -f bin/install_nodejs ]; then
echo "-----> Running install_nodejs"
chmod +x bin/install_nodejs
bin/install_nodejs

# PUT YOUR NPM INSTALL LINES HERE: (less and iced-coffee-script for example)
npm install -g less@1.7.3
npm install -g yuglify@0.1.4
npm install -g uglify-js@2.4.14
fi

python app/manage.py migrate --noinput

echo "-----> Post-compile done"
