---
- name: Create volume folder structure
  file: dest={{ item.dest }} state=directory
  with_items:
    - dest: /gamecraft/config
    - dest: /gamecraft/logs
    - dest: /gamecraft/uploads
    - dest: /gamecraft/backups
  tags:
    - gamecraft

- name: Write out gamecraft django.yml
  template: src=django.yml.j2 dest=/gamecraft/config/django.yml mode=0644
  tags:
    - config
    - gamecraft
  notify:
    - Restart gamecraft

- name: Ensure gamecraft is started
  docker:
    image={{gamecraft_image}}
    name=gamecraft
    state=running
    links={{gamecraft_links}}
    volumes={{gamecraft_volumes}}
  tags:
    - gamecraft
    - docker
